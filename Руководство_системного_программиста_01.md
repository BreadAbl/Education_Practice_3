ТЕХНИЧЕСКОЕ РУКОВОДСТВО ДЛЯ СИСТЕМНОГО СПЕЦИАЛИСТА
Платформа управления заявками на обслуживание бытовых приборов

Релиз: 1.0
Дата выпуска: 25.12.2025

1. ОБЩИЕ ПОЛОЖЕНИЯ
Данный документ адресован системному специалисту, отвечающему за развёртывание, конфигурирование, мониторинг и сопровождение платформы управления обращениями на ремонт бытовой техники (далее — «Платформа»).

1.1 Целевое назначение платформы
Платформа разработана для автоматизации работы с обращениями на ремонт бытовых приборов в сервисных организациях. Основной функционал:

Приём и фиксация обращений от потребителей

Распределение заданий между специалистами

Мониторинг состояния обращений в режиме реального времени

Генерация статистических данных и отчётности о выполненных работах

Разграничение прав доступа для различных категорий пользователей

1.2 Структура платформы
Платформа построена по трёхуровневой схеме:

text
┌─────────────────────────────────────────┐
│     КЛИЕНТСКАЯ ЧАСТЬ (JS/HTML/CSS)      │
│  Пользовательский веб-интерфейс        │
└──────────────────┬──────────────────────┘
                   │
┌──────────────────▼──────────────────────┐
│    СЕРВЕРНАЯ ЧАСТЬ (Flask/Python)       │
│  REST API, бизнес-правила, авторизация  │
└──────────────────┬──────────────────────┘
                   │
┌──────────────────▼──────────────────────┐
│        ХРАНИЛИЩЕ (PostgreSQL)           │
│  Данные о заявках и учётных записях     │
└─────────────────────────────────────────┘
2. СИСТЕМНЫЕ ТРЕБОВАНИЯ
2.1 Аппаратное обеспечение сервера
Операционная система: Windows Server 2019+ либо Linux (Ubuntu 20.04+)

Центральный процессор: Intel Core i5 или аналог (не менее 2 ядер)

Оперативная память: 4 ГБ минимально, 8 ГБ оптимально

Дисковое пространство: 50 ГБ (для СУБД и журналов)

Сетевое оборудование: Проводное соединение 100 Мбит/с+

2.2 Программное обеспечение
Python: версия 3.8 и выше

PostgreSQL: версия 12 и выше

Node.js/npm: для компиляции клиентской части (опционально)

Git: для контроля версий исходного кода

Docker: для контейнеризации (опционально)

2.3 Сетевая конфигурация
IP-адрес сервера: 192.168.0.21 (статический)

Порт веб-приложения: 5000

Порт СУБД: 5432

Межсетевой экран: разрешить порты 5000 (API) и 80/443 (HTTP/HTTPS)

3. ПРОЦЕДУРА УСТАНОВКИ И КОНФИГУРИРОВАНИЯ
3.1 Установка библиотек Python
bash
# Создание виртуального окружения
python -m venv venv

# Активация виртуального окружения
# В Windows:
venv\Scripts\activate
# В Linux/Mac:
source venv/bin/activate

# Установка необходимых пакетов
pip install -r requirements.txt
3.2 Конфигурационные параметры
Создайте файл .env в корневом каталоге проекта:

text
FLASK_ENV=production
SECRET_KEY=your-secret-key-here-change-in-production
DATABASE_URL=postgresql://user:password@localhost:5432/technic_db
FEEDBACK_FORM_URL=https://docs.google.com/forms/d/e/1FAIpQLSdhZcExx6LSIXxk0ub55mSu-WIh23WYdGG9HY5EZhLDo7P8eA/viewform
DEBUG=False
3.3 Инициализация хранилища данных
bash
# Создание пустой базы данных в PostgreSQL
createdb technic_db

# Применение схемы БД
psql technic_db < technic_bd.sql

# Инициализация Flask-приложения
python
>>> from app import create_app
>>> app = create_app()
>>> from database import init_db
>>> init_db(app)
3.4 Запуск веб-приложения
bash
# Режим разработки
python app.py

# Продуктивный режим (с использованием Gunicorn)
gunicorn --bind 192.168.0.21:5000 app:create_app()
4. ОРГАНИЗАЦИЯ ПРОЕКТА
text
project/
├── app.py                 # Основное Flask-приложение
├── config.py              # Параметры конфигурации
├── database.py            # Подключение к БД
├── requirements.txt       # Список библиотек Python
│
├── routes/                # Маршруты API
│   ├── auth.py           # Авторизация пользователей
│   ├── users.py          # Работа с пользователями
│   ├── requests.py       # Работа с заявками
│   ├── comments.py       # Комментарии
│   └── statistics.py     # Аналитика
│
├── models/                # Модели данных (SQLAlchemy)
│   ├── user.py
│   ├── request.py
│   ├── comment.py
│   └── ...
│
├── middleware/            # Промежуточные обработчики
│   └── auth_middleware.py # Валидация JWT токенов
│
├── services/              # Бизнес-логика
│   └── statistics_service.py
│
├── frontend/              # Клиентский интерфейс
│   ├── index.html        # Стартовая страница
│   ├── dashboard.html    # Панель управления
│   ├── statistics.html   # Аналитика
│   │
│   ├── css/
│   │   └── style.css
│   │
│   └── js/
│       ├── config.js     # Настройки клиента
│       ├── auth.js       # Авторизация
│       ├── requests.js   # Управление заявками
│       ├── users.js      # Управление пользователями
│       └── ...
│
└── tests/                 # Автотесты
    └── test_windows.py
5. АДМИНИСТРИРОВАНИЕ ХРАНИЛИЩА ДАННЫХ
5.1 Схема основных таблиц
users — учётные записи пользователей

user_id (первичный ключ)

fullname

email

user_type (Клиент, Мастер, Менеджер)

password_hash

repair_requests — обращения на ремонт

requestid (первичный ключ)

clientid (внешний ключ → users)

masterid (внешний ключ → users)

project

techtype

techmodel

problemdescription

requeststatus (Новая заявка, В работе, Завершена)

startdate

completiondate

comments — примечания к обращениям

commentid (первичный ключ)

requestid (внешний ключ → repair_requests)

masterid (внешний ключ → users)

message

comment_date

5.2 Создание резервных копий
bash
# Формирование резервной копии БД
pg_dump -U postgres technic_db > backup_$(date +%Y%m%d_%H%M%S).sql

# Восстановление данных из копии
psql -U postgres technic_db < backup_20251220_120000.sql
5.3 Контроль состояния БД
bash
# Определение размера БД
psql -U postgres -c "SELECT pg_size_pretty(pg_database_size('technic_db'));"

# Список активных подключений
psql -U postgres -c "SELECT * FROM pg_stat_activity WHERE datname = 'technic_db';"
6. РАЗГРАНИЧЕНИЕ ДОСТУПА И УПРАВЛЕНИЕ ПОЛЬЗОВАТЕЛЯМИ
6.1 Типы ролей в платформе
Роль	Уровень доступа	Возможности
Клиент	Базовый	Создание обращений, просмотр собственных заявок, оценка работы
Мастер	Расширенный доступ к своим задачам	Принятие заявок, выполнение работ, добавление комментариев
Менеджер	Полный доступ	Работа со всеми заявками, назначение исполнителей, управление сроками
Администратор	Полный контроль	Управление учётными записями, конфигурация платформы
6.2 Добавление пользователя
python
# Через Flask shell или в приложении
from models.user import User
from database import db

new_user = User(
    fullname='Иван Петров',
    email='ivan@example.com',
    user_type='Мастер',
    password='hashed_password'
)
db.session.add(new_user)
db.session.commit()
6.3 Контроль прав доступа
python
# Пример middleware для проверки полномочий
@require_auth
def protected_route(current_user):
    if current_user.get('user_type') not in ['Мастер', 'Менеджер']:
        return {'error': 'Недостаточно прав'}, 403
    # ...
7. МОНИТОРИНГ И ЖУРНАЛИРОВАНИЕ
7.1 Журналы работы приложения
Журналы сохраняются в файле: logs/app.log

python
# Активация журналирования для production
import logging
logging.basicConfig(
    filename='logs/app.log',
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s'
)
7.2 Проверка работоспособности системы
bash
# Тестирование доступности API
curl http://192.168.0.21:5000/api/requests/

# Проверка соединения с БД
curl http://192.168.0.21:5000/api/statistics/
7.3 Распространённые проблемы и их устранение
Проблема	Возможная причина	Способ решения
404 Not Found для /api/comments	Маршрут не активирован	Проверить регистрацию comments_bp, убедиться что blueprint подключен
500 Internal Server Error	Ошибка в программном коде	Изучить журналы Flask, анализ traceback
Cannot connect to database	СУБД недоступна	Проверить службу PostgreSQL, правила firewall
Token expired	JWT токен истёк	Получить новый токен через /api/auth/login
8. ОБНОВЛЕНИЕ И РАЗВЁРТЫВАНИЕ
8.1 Установка новой версии
bash
# 1. Получение обновлённого кода
git pull origin main

# 2. Установка новых зависимостей
pip install -r requirements.txt

# 3. Применение миграций БД (при наличии)
# ... команды миграции ...

# 4. Перезапуск приложения
systemctl restart flask-app  # На Linux с systemd
# либо перезапуск Flask вручную
8.2 Откат на предыдущую версию
bash
git revert HEAD
git push origin main
9. ОБЕСПЕЧЕНИЕ БЕЗОПАСНОСТИ
9.1 Политика паролей
Минимальная длина 8 символов

Использование прописных и строчных букв

Наличие цифр и специальных символов

Периодическая смена (каждые 90 дней)

9.2 Хеширование паролей
python
# Использование bcrypt для безопасного хранения паролей
from werkzeug.security import generate_password_hash, check_password_hash

hashed = generate_password_hash('password123')
check_password_hash(hashed, 'password123')  # True
9.3 Работа с JWT токенами
Токены действительны в течение 24 часов и передаются в заголовке запроса:

text
Authorization: Bearer <token>
10. КОНТАКТНАЯ ИНФОРМАЦИЯ И ТЕХНИЧЕСКАЯ ПОДДЕРЖКА
Ответственный разработчик: Иванов Иван Иванович
Email: ivan@techservice.ru
Телефон: +7 (999) 123-45-67

Служба технической поддержки: support@techservice.ru
График работы: Пн-Пт 9:00-18:00 (МСК)
